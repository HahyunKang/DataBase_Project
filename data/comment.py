import psycopg2
import csv

from prettytable import PrettyTable

from connect import connect


def region():
    try:
        conn = connect()
        cursor = conn.cursor()
        cursor.execute("DROP TABLE IF EXISTS Comment;")
        cursor.execute(
            """CREATE TABLE Comment (commentId SERIAL, postID INT, content VARCHAR, writerId INT, PRIMARY KEY(commentId)); """
        )

        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (3, ' 홈페이지 가면 알 수 있어요!', 100);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (100, '같이 힘내봐요..ㅠㅠ', 3);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (3, '정보 어디서 구하셨나요?', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (1, '대단해요....고생하시네요', 20);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (20, '그런 정보 어디서 구함?', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (23, '어렵다', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (13, '취업 어떻게할지...막막하다', 22);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (3, '데이터베이스 배워봐용', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (4, '이거 어케 해?;', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (28, '이겨내봅시다', 5);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (31, '하기 싫다;;', 6);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (100, '에휴', 67);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (34, '정보 졈', 85);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (23, '나도 알려조', 22);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (43, '그런 정보 어디서 구함?', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (25, '어렵다', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (18, '취업 ㄹㅇ 어려움', 35);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (19, '데배 개꿀잼', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (20, '이거 어케 해?;', 47);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (31, '하기 싫다;;', 83);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (38, '이겨내ㅋ;;', 25);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (100, '에휴', 75);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (45, '정보 졈', 7);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (52, '나도 알려조', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (34, '그런 정보 어디서 구함?', 57);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (53, '이겨내ㅋ', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (68, '취업 ㄹㅇ 어려움', 64);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (12, '데배 개꿀잼', 25);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (42, '이거 어케 해?;', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (44, '하기 싫다;;', 37);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (9, '이겨내ㅋ', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (14, '에휴', 22);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (23, '정보 졈', 57);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (15, '나도 알려조', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (1, '그런 정보 어디서 구함?', 84);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (3, '어렵다', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (23, '취업 ㄹㅇ 어려움', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (4, '데배 개꿀잼', 24);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (64, '이거 어케 해?;', 57);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (6, '하기 싫다;;', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (5, '하기 싫다;;', 75);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (13, '에휴', 48);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (24, '정보 졈', 38);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (23, '이겨내ㅋ', 95);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (53, '그런 정보 어디서 구함?', 100);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (75, '어렵다', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (37, '취업 ㄹㅇ 어려움', 63);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (72, '데배 개꿀잼', 75);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (46, '이거 어케 해?;', 27);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (64, '하기 싫다;;', 18);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (42, '하기 싫다;;', 19);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (63, '에휴', 93);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (26, '정보 졈', 36);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (26, '나도 알려조', 75);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (17, '그런 정보 어디서 구함?', 46);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (47, '이겨내ㅋ', 1);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (26, '취업 ㄹㅇ 어려움', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (63, '데배 개꿀잼', 22);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (26, '이겨내ㅋ', 33);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (27, '하기 싫다;;', 44);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (2, '이겨내ㅋ', 64);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (62, '에휴', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (16, '정보 졈', 30);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (2, '나도 알려조', 1);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (64, '그런 정보 어디서 구함?', 12);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (25, '어렵다', 1);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (25, '취업 ㄹㅇ 어려움', 55);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (26, '데배 개꿀잼', 66);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (27, '이거 어케 해?;', 77);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (17, '하기 싫다;;', 88);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (25, '하기 싫다;;', 99);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (63, '에휴', 79);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (27, '정보 졈', 59);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (16, '나도 알려조', 21);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (38, '그런 정보 어디서 구함?', 54);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (15, '어렵다', 19);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (35, '취업 ㄹㅇ 어려움', 63);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (72, '데배 개꿀잼', 68);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (74, '이거 어케 해?;', 79);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (15, '하기 싫다;;', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (35, '하기 싫다;;', 47);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (62, '에휴', 49);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (15, '정보 졈', 91);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (6, '나도 알려조', 93);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (7, '그런 정보 어디서 구함?', 35);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (3, '어렵다', 74);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (2, '취업 ㄹㅇ 어려움', 26);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (6, '데배 개꿀잼', 73);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (10, '이거 어케 해?;', 59);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (11, '이겨내ㅋ', 47);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (66, '하기 싫다;;', 44);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (22, '에휴', 2);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (44, '정보 졈', 1);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (33, '나도 알려조', 3);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (55, '그런 정보 어디서 구함?', 5);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (66, '어렵다', 6);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (77, '취업 ㄹㅇ 어려움', 7);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (88, '데배 개꿀잼', 8);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (99, '이거 어케 해?;', 9);")
        cursor.execute("INSERT INTO Comment(postID, content, writerId) VALUES (15, '이겨내ㅋ', 10);")

        cursor.execute("SELECT * FROM Comment")
        res = cursor.fetchall()
        columns = [desc[0] for desc in cursor.description]
        table = PrettyTable(columns)
        for data in res:
            table.add_row(data)
        print(table)


    except psycopg2.Error as e:
        print("Connection failure.")
        raise e

if __name__ == "__main__":
    region()